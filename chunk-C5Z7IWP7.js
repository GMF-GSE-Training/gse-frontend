import{b as se}from"./chunk-UOICQBZ7.js";import{a as b}from"./chunk-SF56SLL6.js";import"./chunk-O5IUEWYX.js";import{b as oe}from"./chunk-FBVENKOP.js";import"./chunk-3FGHHD2R.js";import{c as z,d as J,e as X,f as Z,g as $,k as ee,o as ie,q as te,s as ae,t as re,u as ne}from"./chunk-6ITL565O.js";import"./chunk-QKGMZ23H.js";import{a as k}from"./chunk-WUFTDP6O.js";import{a as q,b as I}from"./chunk-W5GHEU6T.js";import{a as L}from"./chunk-G57N2EQR.js";import{C as y,g as E,r as N,t as h,u as Y,z as B}from"./chunk-3V2U2C6V.js";import{Cb as x,Db as W,Eb as G,Fb as K,Gb as H,Kb as P,Lb as T,Mb as R,Na as u,Ob as U,S as M,Sa as o,Xa as c,Ya as w,ba as f,c as _,ca as C,f as O,hb as p,ka as V,nb as s,ob as m,pb as v,sb as Q,vb as g}from"./chunk-VF5RWILG.js";var ue=()=>["super admin"],A=(()=>{class r{constructor(t,i,e,a){this.capabilityService=t,this.router=i,this.route=e,this.sweetalertService=a,this.pageTitle="Capability",this.columns=[{header:"Kode Rating",field:"ratingCode"},{header:"Kode Training",field:"trainingCode"},{header:"Nama Training",field:"trainingName"},{header:"Durasi Materi Regulasi GSE",field:"durasiMateriRegulasGSE"},{header:"Durasi Materi Kompetensi",field:"durasiMateriRating"},{header:"Total Durasi",field:"totalDuration"},{header:"Kurikulum & Silabus",field:"kurikulumSilabus"},{header:"Action",field:"action"}],this.capability=[],this.isLoading=!1,this.currentPage=1,this.totalPages=1,this.itemsPerPage=10,this.searchQuery="",this.placeHolder="Cari Capability"}ngOnInit(){this.route.queryParams.subscribe(t=>{this.searchQuery=t.keyword||"",this.currentPage=+t.page||1,this.getListCapability(this.searchQuery,this.currentPage,this.itemsPerPage)})}getListCapability(t,i,e){this.isLoading=!0,this.capabilityService.listCapability(t,i,e).subscribe({next:({data:a,actions:n,paging:l})=>{this.capability=a.map(d=>({id:d.id,ratingCode:d.ratingCode,trainingCode:d.trainingCode,trainingName:d.trainingName,durasiMateriRegulasGSE:d.totalMaterialDurationRegGse??"-",durasiMateriRating:d.totalMaterialDurationCompetency,totalDuration:d.totalDuration??"-",kurikulumSilabus:`/capability/${d.id}/curriculum-syllabus`,editLink:n?.canEdit?`/capability/${d.id}/edit`:null,deleteMethod:n?.canDelete?()=>this.deleteCapability(d):null})),this.totalPages=l?.totalPage||1},error:a=>{console.log(a),this.isLoading=!1},complete:()=>{this.isLoading=!1}})}deleteCapability(t){return O(this,null,function*(){(yield this.sweetalertService.confirm("Anda Yakin?",`Apakah anda ingin menghapus capability ini : ${t.trainingName}?`,"warning","Ya, hapus!"))&&(this.sweetalertService.loading("Mohon tunggu","Proses..."),this.capabilityService.deleteCapability(t.id).subscribe({next:()=>{this.sweetalertService.alert("Dihapus!","Data capability berhasil dihapus","success"),this.capability=this.capability.filter(a=>a.id!==t.id),this.capability.length===0&&this.currentPage>0&&(this.currentPage-=1),this.getListCapability(this.searchQuery,this.currentPage,this.itemsPerPage),this.currentPage>this.totalPages&&(this.currentPage=this.totalPages);let e=this.searchQuery?{keyword:this.searchQuery,page:this.currentPage}:{page:this.currentPage};this.router.navigate([],{relativeTo:this.route,queryParams:e,queryParamsHandling:"merge"})},error:()=>{this.sweetalertService.alert("Pemberitahuan","Server sedang sibuk atau terjadi gangguan. Silakan coba beberapa saat lagi.","error")}}))})}onSearchChanged(t){t.trim()===""?this.router.navigate([],{queryParams:{keyword:null,page:null},queryParamsHandling:"merge"}):this.router.navigate([],{queryParams:{keyword:t,page:1},queryParamsHandling:"merge"})}onPageChanged(t){this.router.navigate([],{queryParams:{page:t},queryParamsHandling:"merge"})}viewAll(){this.router.navigate([],{relativeTo:this.route,queryParams:{keyword:void 0,page:void 0},queryParamsHandling:"merge"}),this.searchQuery=""}static{this.\u0275fac=function(i){return new(i||r)(o(b),o(h),o(N),o(y))}}static{this.\u0275cmp=c({type:r,selectors:[["app-capability-list"]],decls:2,vars:10,consts:[[3,"pageChange","searchChange","viewAllChange","pageTitle","columns","data","isLoading","totalPages","currentPage","placeHolder","blueButtonRoute","roleBassedAccess"]],template:function(i,e){i&1&&(v(0,"app-header"),s(1,"app-data-management",0),g("pageChange",function(n){return e.onPageChanged(n)})("searchChange",function(n){return e.onSearchChanged(n)})("viewAllChange",function(){return e.viewAll()}),m()),i&2&&(u(),p("pageTitle",e.pageTitle)("columns",e.columns)("data",e.capability)("isLoading",e.isLoading)("totalPages",e.totalPages)("currentPage",e.currentPage)("placeHolder",e.placeHolder)("blueButtonRoute","/capability/add")("roleBassedAccess",U(9,ue)))},dependencies:[oe,k],encapsulation:2})}}return r})();var ce=["form"],j=(()=>{class r{constructor(){this.capability={},this.pageTitle="",this.formSubmit=new V}onSubmit(){this.form.valid&&this.formSubmit.emit(this.capability)}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=c({type:r,selectors:[["app-capability-form"]],viewQuery:function(i,e){if(i&1&&x(ce,5),i&2){let a;W(a=G())&&(e.form=a.first)}},inputs:{capability:"capability",pageTitle:"pageTitle"},outputs:{formSubmit:"formSubmit"},decls:18,vars:8,consts:[["form","ngForm"],["ratingCode","ngModel"],["trainingCode","ngModel"],["trainingName","ngModel"],[1,"container"],[3,"pageTitle"],[3,"submit"],[1,"form-container"],[1,"input-column"],["label","Kode Rating","type","text","inputMode","text","name","ratingCode","required","","autocomplete","off",3,"ngModelChange","isRequired","ngModel"],["label","Kode Training","type","text","inputMode","text","name","trainingCode","required","","autocomplete","off",3,"ngModelChange","isRequired","ngModel"],["label","Nama Training","type","text","inputMode","text","name","trainingName","required","","autocomplete","name",3,"ngModelChange","isRequired","ngModel"],[1,"container-button"],["type","button","routerLink","/capability",1,"button"],["type","submit",1,"button",3,"disabled"]],template:function(i,e){if(i&1){let a=Q();v(0,"app-header"),s(1,"div",4),v(2,"app-title",5),s(3,"form",6,0),g("submit",function(){return f(a),C(e.onSubmit())}),s(5,"div",7)(6,"div",8)(7,"app-base-input",9,1),R("ngModelChange",function(l){return f(a),T(e.capability.ratingCode,l)||(e.capability.ratingCode=l),C(l)}),m(),s(9,"app-base-input",10,2),R("ngModelChange",function(l){return f(a),T(e.capability.trainingCode,l)||(e.capability.trainingCode=l),C(l)}),m(),s(11,"app-base-input",11,3),R("ngModelChange",function(l){return f(a),T(e.capability.trainingName,l)||(e.capability.trainingName=l),C(l)}),m()()(),s(13,"div",12)(14,"app-white-button",13),H(15,"Kembali"),m(),s(16,"app-blue-button",14),H(17,"Simpan"),m()()()()}if(i&2){let a=K(4);u(2),p("pageTitle",e.pageTitle),u(5),p("isRequired",!0),P("ngModel",e.capability.ratingCode),u(2),p("isRequired",!0),P("ngModel",e.capability.trainingCode),u(2),p("isRequired",!0),P("ngModel",e.capability.trainingName),u(5),p("disabled",a.invalid)}},dependencies:[te,re,ne,ae,ie,$,z,J,ee,Z,X,E,Y,k],styles:[".container[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;gap:2em;padding:2em}form[_ngcontent-%COMP%]{background:#fff;padding:2em;border:1px solid #e0e0e0;border-radius:8px;width:100%;margin:25px auto}.form-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%}.input-column[_ngcontent-%COMP%]{align-items:center;width:48%}.container-button[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:4em;width:100%;margin-top:25px}.button[_ngcontent-%COMP%]{width:190px;height:45px}p[_ngcontent-%COMP%]{color:red}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding:2em 1em}form[_ngcontent-%COMP%]{padding:1em}.input-column[_ngcontent-%COMP%]{width:100%}}"]})}}return r})();var D=(()=>{class r{constructor(t,i,e,a){this.capabilityService=t,this.router=i,this.errorHandlerService=e,this.sweetalertService=a,this.capability={id:"",kodeRating:"",kodeTraining:"",namaTraining:""}}onSubmit(t){let a=t,{id:i}=a,e=_(a,["id"]);this.sweetalertService.loading("Mohon tunggu","Proses..."),this.capabilityService.createCapability(e).subscribe({next:n=>{t=n.data,this.sweetalertService.alert("Berhasil!","Capability berhasil dibuat, selanjutnya buat kurikulum & silabus","success"),this.router.navigateByUrl("/curriculum-syllabus/add",{state:{id:t.id,ratingCode:t.ratingCode,trainingName:t.trainingName}})},error:n=>{console.log(n),this.errorHandlerService.alertError(n)}})}static{this.\u0275fac=function(i){return new(i||r)(o(b),o(h),o(L),o(y))}}static{this.\u0275cmp=c({type:r,selectors:[["app-add-capability"]],decls:1,vars:2,consts:[[3,"formSubmit","pageTitle","capability"]],template:function(i,e){i&1&&(s(0,"app-capability-form",0),g("formSubmit",function(n){return e.onSubmit(n)}),m()),i&2&&p("pageTitle","Add Capability")("capability",e.capability)},dependencies:[j],encapsulation:2})}}return r})();var F=(()=>{class r{constructor(t,i,e,a,n){this.capabilityService=t,this.router=i,this.route=e,this.sweetalertService=a,this.errorHandlerService=n,this.capability={id:"",ratingCode:"",trainingCode:"",trainingName:""}}ngOnInit(){let t=this.route.snapshot.paramMap.get("capabilityId");t&&this.capabilityService.getCapabilityById(t).subscribe({next:i=>{this.capability=i.data},error:i=>console.log(i)})}onSubmit(t){let a=t,{id:i}=a,e=_(a,["id"]);this.capabilityService.updateCapability(i,e).subscribe({next:()=>{this.sweetalertService.alert("Berhasil","Capability berhasil diperbarui","success"),this.router.navigateByUrl("/capability")},error:n=>{console.log(n),this.errorHandlerService.alertError(n)}})}static{this.\u0275fac=function(i){return new(i||r)(o(b),o(h),o(N),o(y),o(L))}}static{this.\u0275cmp=c({type:r,selectors:[["app-edit-capability"]],decls:1,vars:2,consts:[[3,"formSubmit","pageTitle","capability"]],template:function(i,e){i&1&&(s(0,"app-capability-form",0),g("formSubmit",function(n){return e.onSubmit(n)}),m()),i&2&&p("pageTitle","Edit Capability")("capability",e.capability)},dependencies:[j],encapsulation:2})}}return r})();var he=[{path:"",component:A},{path:"add",component:D,canActivate:[q,I],data:{roles:["super admin"]}},{path:":capabilityId/edit",component:F,canActivate:[q,I],data:{roles:["super admin"]}},{path:":capabilityId/curriculum-syllabus",component:se,canActivate:[q,I],data:{roles:["super admin","supervisor","lcu","user"]}}],de=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=w({type:r})}static{this.\u0275inj=M({imports:[B.forChild(he),B]})}}return r})();var ei=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=w({type:r})}static{this.\u0275inj=M({imports:[E,de,A,D,F]})}}return r})();export{ei as CapabilityModule};
