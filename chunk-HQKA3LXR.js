import{a as G,b as Le}from"./chunk-OW7KK6E6.js";import"./chunk-VCYNDTNL.js";import{a as Z,b as Ae,c as J,d as re,e as ne}from"./chunk-LLJUXWRW.js";import{a as A}from"./chunk-2RU2G2GG.js";import{a as Te,b as P,c as M}from"./chunk-ERSWCUUE.js";import{a as Ie,b as Re,c as H,d as z,e as W,f as U,g as K,k as Q,l as Oe,m as Fe,n as je,o as E,p as Ne}from"./chunk-HA77R4EW.js";import{d as j,g as y,h as Ee,i as ge,o as Ve,r as N,t as C,u as q,z as he}from"./chunk-PTR267HX.js";import{Cb as V,Db as T,Eb as I,Fb as L,Gb as m,Hb as Se,Ib as ie,Kb as R,Lb as O,Mb as F,Na as g,Nb as xe,O as be,Q as ye,R as Pe,S as B,Sa as c,Tb as fe,U as Me,W as de,X as te,Xa as h,Ya as D,ab as S,ba as u,ca as f,hb as l,i as pe,ka as v,la as ue,nb as o,ob as a,pb as w,sb as x,ta as ke,vb as d,wb as b}from"./chunk-NHTCOLVS.js";var Ke=["captcha"],we=new Me("CAPTCHA_CONFIG");function Be(r){return new pe(_=>{if(!window)return;if(typeof window.hcaptcha<"u"){_.next(),_.complete();return}let e="https://hcaptcha.com/1/api.js?render=explicit";r&&(e+=`&hl=${r}`);let t=document.createElement("script");t.src=e,t.async=!0,t.defer=!0,t.onerror=i=>_.error(i),t.onload=()=>{_.next(),_.complete()},document.head.appendChild(t)})}var De=(()=>{class r{constructor(e,t,i){this.config=e,this.zone=t,this.platformId=i,this.verify=new v,this.expired=new v,this.error=new v,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){this.languageCode||(this.languageCode=this.config.languageCode),!ge(this.platformId)&&(this.captcha$=Be(this.languageCode).subscribe(()=>{setTimeout(e=>{let t={sitekey:e.siteKey||e.config.siteKey,theme:e.theme,size:e.size,tabindex:e.tabIndex,callback:i=>{e.zone.run(()=>e.onVerify(i))},"expired-callback":i=>{e.zone.run(()=>e.onExpired(i))},"error-callback":i=>{e.zone.run(()=>e.onError(i))}};e.widgetId=window.hcaptcha.render(e.captcha.nativeElement,t)},50,this)},e=>{console.error("Failed to load hCaptcha script",e)}))}ngOnDestroy(){ge(this.platformId)||this.captcha$.unsubscribe()}writeValue(e){this.value=e,Ee(this.platformId)&&!this.value&&window.hcaptcha&&window.hcaptcha.reset(this.widgetId)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}reset(){window.hcaptcha.reset(this.widgetId)}get value(){return this._value}set value(e){this._value=e,this.onChange(e),this.onTouched()}onVerify(e){this.value=e,this.verify.emit(e)}onExpired(e){this.expired.emit(e)}onError(e){this.error.emit(e)}static{this.\u0275fac=function(t){return new(t||r)(c(we),c(ue),c(ke))}}static{this.\u0275cmp=h({type:r,selectors:[["ng-hcaptcha"]],viewQuery:function(t,i){if(t&1&&V(Ke,7),t&2){let n;T(n=I())&&(i.captcha=n.first)}},inputs:{siteKey:"siteKey",theme:"theme",size:"size",tabIndex:"tabIndex",languageCode:"languageCode"},outputs:{verify:"verify",expired:"expired",error:"error"},standalone:!1,features:[xe([{provide:Ie,useExisting:ye(()=>r),multi:!0}])],decls:2,vars:0,consts:[["captcha",""],[1,"h-captcha"]],template:function(t,i){t&1&&w(0,"div",1,0)},encapsulation:2})}}return r})();var Qe=(()=>{class r{constructor(e,t){this.captchaConfig=e,this.zone=t}verify(){return new pe(e=>{Be(this.captchaConfig.languageCode).subscribe(()=>{setTimeout(t=>{if(this.hCaptchaElement||(this.hCaptchaElement=document.createElement("div"),document.body.appendChild(this.hCaptchaElement)),!this.hCaptchaWidgetId){let i={sitekey:this.captchaConfig.siteKey,size:"invisible",callback:n=>{this.zone.run(()=>{e.next(n),e.complete(),this.resetHcaptcha()})},"expired-callback":n=>{this.zone.run(()=>{e.error(n),this.resetHcaptcha()})},"error-callback":n=>{this.zone.run(()=>{e.error(n),this.resetHcaptcha()})}};this.hCaptchaWidgetId=window.hcaptcha.render(this.hCaptchaElement,i)}window.hcaptcha.execute(this.hCaptchaWidgetId)},50,this)})})}resetHcaptcha(){window.hcaptcha.remove(this.hCaptchaWidgetId),this.hCaptchaElement=null,this.hCaptchaWidgetId=null}static{this.\u0275fac=function(t){return new(t||r)(de(we),de(ue))}}static{this.\u0275prov=Pe({token:r,factory:r.\u0275fac})}}return r})(),X=(()=>{class r{static forRoot(e){return{ngModule:r,providers:[Qe,{provide:we,useValue:e||[]}]}}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275mod=D({type:r})}static{this.\u0275inj=B({})}}return r})();var Ze=["form"];function Je(r,_){if(r&1&&(o(0,"div",17),w(1,"i",18),o(2,"span"),m(3),a()()),r&2){let e=b();g(3),Se(e.message)}}var He=(()=>{class r{constructor(){this.loginError=!1,this.message="",this.loginRequest={identifier:"",password:""},this.isPassVisible=!1,this.isLoading=!1,this.formSubmit=new v}passVisible(){this.isPassVisible=!this.isPassVisible}onSubmit(){this.form.valid&&(this.loginRequest.identifier&&(this.loginRequest.identifier=this.loginRequest.identifier.trim()),this.formSubmit.emit(this.loginRequest))}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=h({type:r,selectors:[["app-login-form"]],viewQuery:function(t,i){if(t&1&&V(Ze,5),t&2){let n;T(n=I())&&(i.form=n.first)}},inputs:{loginError:"loginError",message:"message",loginRequest:"loginRequest",isPassVisible:"isPassVisible",isLoading:"isLoading"},outputs:{formSubmit:"formSubmit"},decls:24,vars:7,consts:[["form","ngForm"],["identifier","ngModel"],["password","ngModel"],[1,"form-container"],[1,"login-form",3,"ngSubmit"],["pageTitle","Login Account"],["class","alert-error-custom mt-2",4,"ngIf"],[1,"fa-solid","fa-user","user-icon"],["type","text","name","identifier","autocomplete","username","placeholder","Email atau No. Pegawai","required","",3,"ngModelChange","ngModel"],[1,"fa-solid","fa-lock","pass-icon"],[3,"togglePassClick","isPassVisible"],["name","password","autocomplete","current-password","placeholder","Password","required","",3,"ngModelChange","ngModel","type"],["routerLink","/password-reset",1,"auth-helper-links"],[1,"register-link-container"],[1,"register-link"],["routerLink","/register"],[1,"button",3,"type","disabled"],[1,"alert-error-custom","mt-2"],[1,"fa-solid","fa-circle-exclamation"]],template:function(t,i){if(t&1){let n=x();o(0,"app-auth")(1,"div",3)(2,"form",4,0),d("ngSubmit",function(){return u(n),f(i.onSubmit())}),w(4,"app-title",5),S(5,Je,4,1,"div",6),o(6,"div"),w(7,"i",7),o(8,"input",8,1),F("ngModelChange",function(p){return u(n),O(i.loginRequest.identifier,p)||(i.loginRequest.identifier=p),f(p)}),a(),w(10,"i",9),o(11,"app-toggle-password-visibility",10),d("togglePassClick",function(){return u(n),f(i.passVisible())}),a(),o(12,"input",11,2),F("ngModelChange",function(p){return u(n),O(i.loginRequest.password,p)||(i.loginRequest.password=p),f(p)}),a()(),o(14,"div")(15,"a",12),m(16,"Lupa Password?"),a()(),o(17,"div",13)(18,"span",14),m(19,"Belum punya akun? "),o(20,"a",15),m(21,"Daftar"),a()()(),o(22,"app-blue-button",16),m(23,"Masuk"),a()()()()}if(t&2){let n=L(3);g(5),l("ngIf",i.loginError),g(3),R("ngModel",i.loginRequest.identifier),g(3),l("isPassVisible",i.isPassVisible),g(),R("ngModel",i.loginRequest.password),l("type",i.isPassVisible?"text":"password"),g(10),l("type","submit")("disabled",n.invalid||i.isLoading)}},dependencies:[G,Z,Ae,J,q,y,j,E,K,Re,H,z,Q,U,W],styles:[".form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;min-height:100vh;overflow:auto;background:#fff;border-radius:16px;box-shadow:0 2px 8px #0000000f;padding:2em;box-sizing:border-box;overflow-x:hidden}.login-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:2em;width:100%;max-width:520px;min-width:320px;padding:0 1.5em}input[_ngcontent-%COMP%]{font-size:1em;font-weight:700;padding-left:50px;border:none;outline:none;border-bottom:2px solid #000;height:40px}i[_ngcontent-%COMP%]{font-size:30px;position:relative;max-width:30px;max-height:30px}.user-icon[_ngcontent-%COMP%]{top:1.5em}.pass-icon[_ngcontent-%COMP%]{top:2.5em}app-toggle-password-visibility[_ngcontent-%COMP%]{position:relative;top:2em;left:90%}.register-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#02507e}.login-form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;font-weight:700;gap:10px}.register-link-container[_ngcontent-%COMP%]{align-items:center}.auth-helper-links[_ngcontent-%COMP%]{color:#02507e}.error-message[_ngcontent-%COMP%]{display:flex;justify-content:center;background-color:#ffeeba;padding:2px;position:relative;top:6em;color:red;font-weight:700;width:100%}.button[_ngcontent-%COMP%]{width:190px;height:45px}@media screen and (max-width: 1200px){.login-form[_ngcontent-%COMP%]{max-width:420px;padding:0 1em}}@media screen and (max-width: 900px){.form-container[_ngcontent-%COMP%]{padding:2em 1em}.login-form[_ngcontent-%COMP%]{max-width:100%;min-width:0;padding:0 .5em}}@media screen and (max-width: 600px){.form-container[_ngcontent-%COMP%]{padding:1em .5em}.login-form[_ngcontent-%COMP%]{max-width:100%;min-width:0;padding:0 .25em}}.alert-error-custom[_ngcontent-%COMP%]{background:#fdecea;color:#b71c1c;border:1px solid #f5c6cb;border-radius:6px;padding:10px 14px;margin-top:8px;font-size:15px;display:flex;align-items:center;gap:8px}.alert-error-custom[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#b71c1c;font-size:18px}"]})}}return r})();var se=(()=>{class r{constructor(e,t,i){this.router=e,this.authService=t,this.sweetalertService=i,this.isPassVisible=!1,this.loginRequest={identifier:"",password:""},this.loginError=!1,this.message="",this.isLoading=!1}passVisible(){this.isPassVisible=!this.isPassVisible}login(){this.isLoading=!0,this.authService.login(this.loginRequest).subscribe({next:e=>{let t=e.data;if(this.loginError=!1,this.isLoading=!1,t&&t.role?.name==="user"&&t.participant){let i=t.participant;if(!(i&&i.dateOfBirth&&i.placeOfBirth&&i.phoneNumber)){this.sweetalertService.alert("Peringatan","Data anda belum lengkap, silahkan lengkapi data terlebih dahulu","warning"),this.router.navigate(["/participants",i.id,"edit"]);return}}this.router.navigateByUrl("/dashboard")},error:e=>{console.log(e),this.loginError=!0,this.isLoading=!1,e.status===404?this.message="Akun Anda belum terdaftar. Silakan lakukan pendaftaran untuk mengakses layanan.":e.status===400?this.message="Kata sandi yang Anda masukkan salah.":e.status===403?this.message='Akun Anda belum terverifikasi. Silakan klik menu "Belum Terverifikasi?" untuk mengirim ulang email verifikasi.':this.message="Server sedang sibuk atau terjadi gangguan. Silakan coba beberapa saat lagi."}})}static{this.\u0275fac=function(t){return new(t||r)(c(C),c(P),c(M))}}static{this.\u0275cmp=h({type:r,selectors:[["app-login"]],decls:1,vars:5,consts:[[3,"formSubmit","loginRequest","loginError","message","isPassVisible","isLoading"]],template:function(t,i){t&1&&(o(0,"app-login-form",0),d("formSubmit",function(){return i.login()}),a()),t&2&&l("loginRequest",i.loginRequest)("loginError",i.loginError)("message",i.message)("isPassVisible",i.isPassVisible)("isLoading",i.isLoading)},dependencies:[y,Ve,E,He],encapsulation:2})}}return r})();var ce=(()=>{class r{constructor(e,t,i,n){this.authService=e,this.sweetalertService=t,this.handleErrorService=i,this.router=n,this.registerUserRequest={idNumber:"",nik:"",email:"",name:"",password:"",dinas:""},this.isSuccess=!1,this.registerMessage="",this.isLoading=!1}onRegister(e){this.cleanEmptyFields(e),this.sweetalertService.loading("Mohon tunggu","Proses..."),this.authService.register(e).subscribe({next:()=>{this.sweetalertService.close(),this.isSuccess=!0,this.sweetalertService.alert("Berhasil","Registrasi berhasil. Silakan login, dan cek email (inbox/spam) untuk verifikasi akun.","success").then(()=>this.router.navigateByUrl("/auth/login"))},error:t=>{console.log(t),this.sweetalertService.close(),this.isSuccess=!1,this.registerMessage=this.handleErrorService.getErrorMessage(t,["nik","email","nama","password"])}})}cleanEmptyFields(e){for(let t in e)e.hasOwnProperty(t)&&e[t]===""&&(e[t]=void 0)}register(){this.isLoading=!0,this.authService.register(this.registerUserRequest).subscribe({next:e=>{this.isLoading=!1,this.sweetalertService.alert("Berhasil","Registrasi berhasil. Tautan verifikasi telah dikirim ke email Anda. Periksa kotak masuk/spam.","success").then(()=>this.router.navigateByUrl("/auth/login"))},error:e=>{if(this.sweetalertService.close(),console.log(e),e.status===503){this.isLoading=!1,this.sweetalertService.alert("Peringatan",'Akun Anda sudah terdaftar, namun sistem gagal mengirim email verifikasi. Silakan verifikasi akun Anda di menu "Belum Terverifikasi?".',"warning").then(()=>this.router.navigateByUrl("/auth/verification"));return}this.isLoading=!1,this.handleErrorService.alertError(e)}})}static{this.\u0275fac=function(t){return new(t||r)(c(P),c(M),c(A),c(C))}}static{this.\u0275cmp=h({type:r,selectors:[["app-register"]],decls:1,vars:6,consts:[["blueButtonLabel","Daftar",3,"formSubmit","isRegister","isCreate","pageTitle","user","isSuccess","registerMessage"]],template:function(t,i){t&1&&(o(0,"app-user-form",0),d("formSubmit",function(s){return i.onRegister(s)}),a()),t&2&&l("isRegister",!0)("isCreate",!0)("pageTitle","Create Account")("user",i.registerUserRequest)("isSuccess",i.isSuccess)("registerMessage",i.registerMessage)},dependencies:[Le],encapsulation:2})}}return r})();var Xe=["form"];function Ye(r,_){r&1&&(o(0,"div",14),w(1,"i",15),o(2,"span")(3,"b"),m(4,"Penting:"),a(),w(5,"br"),o(6,"span"),m(7,"\u{1F5D1}\uFE0F Akun yang belum diverifikasi dalam "),o(8,"b"),m(9,"24 jam"),a(),m(10," akan dihapus otomatis."),a(),w(11,"br"),o(12,"span"),m(13,"\u{1F4E7} Jangan lupa cek folder "),o(14,"b"),m(15,"Inbox"),a(),m(16," atau "),o(17,"b"),m(18,"Spam"),a(),m(19," Anda."),a()()())}function $e(r,_){if(r&1&&(o(0,"div",16),w(1,"i",17),m(2),a()),r&2){let e=b();g(2),ie(" ",e.errorMessage," ")}}var Y=(()=>{class r{constructor(){this.pageTitle="",this.isSubmitted=!1,this.submitError=!1,this.data={email:""},this.errorMessage="",this.hcaptchaToken="",this.formSubmit=new v,this.captchaVerified=new v,this.captchaExpired=new v,this.captchaError=new v}onSubmit(){this.form.valid&&this.formSubmit.emit(this.data)}isEmailValid(e){return/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(e)}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=h({type:r,selectors:[["app-email-form"]],viewQuery:function(t,i){if(t&1&&V(Xe,5),t&2){let n;T(n=I())&&(i.form=n.first)}},inputs:{pageTitle:"pageTitle",isSubmitted:"isSubmitted",submitError:"submitError",data:"data",errorMessage:"errorMessage",hcaptchaToken:"hcaptchaToken"},outputs:{formSubmit:"formSubmit",captchaVerified:"captchaVerified",captchaExpired:"captchaExpired",captchaError:"captchaError"},decls:17,vars:7,consts:[["form","ngForm"],["email","ngModel"],[1,"form-container"],[1,"form",3,"ngSubmit"],[3,"pageTitle"],["class","alert alert-warning","style","margin-bottom: 15px; padding: 10px; border-radius: 5px; background-color: #fff3cd; color: #856404; border: 1px solid #ffeeba;",4,"ngIf"],[1,"input-container"],["label","Email","type","email","autocomplete","email","inputMode","email","placeholder","Email yang terdaftar","name","email","required","",1,"input",3,"ngModelChange","ngModel","isRequired","email"],["class","alert-error-custom",4,"ngIf"],[1,"captcha-container"],[3,"verify","expired","error"],[1,"buttons-container"],["type","button","routerLink","/login",1,"button"],["type","submit",1,"button",3,"disabled"],[1,"alert","alert-warning",2,"margin-bottom","15px","padding","10px","border-radius","5px","background-color","#fff3cd","color","#856404","border","1px solid #ffeeba"],[1,"fa-solid","fa-exclamation-triangle",2,"margin-right","5px"],[1,"alert-error-custom"],[1,"fa-solid","fa-circle-exclamation"]],template:function(t,i){if(t&1){let n=x();o(0,"app-auth")(1,"div",2)(2,"form",3,0),d("ngSubmit",function(){return u(n),f(i.onSubmit())}),w(4,"app-title",4),S(5,Ye,20,0,"div",5),o(6,"div",6)(7,"app-base-input",7,1),F("ngModelChange",function(p){return u(n),O(i.data.email,p)||(i.data.email=p),f(p)}),a(),S(9,$e,3,1,"div",8),o(10,"div",9)(11,"ng-hcaptcha",10),d("verify",function(p){return u(n),f(i.captchaVerified.emit(p))})("expired",function(){return u(n),f(i.captchaExpired.emit())})("error",function(p){return u(n),f(i.captchaError.emit(p))}),a()()(),o(12,"div",11)(13,"app-white-button",12),m(14,"Kembali"),a(),o(15,"app-blue-button",13),m(16,"Kirim"),a()()()()()}t&2&&(g(4),l("pageTitle",i.pageTitle),g(),l("ngIf",i.pageTitle==="Account Verification"),g(2),R("ngModel",i.data.email),l("isRequired",!0)("email",!0),g(2),l("ngIf",i.errorMessage),g(6),l("disabled",!i.data.email||!i.hcaptchaToken))},dependencies:[Z,re,ne,J,E,K,H,z,Q,Oe,U,W,y,j,G,q,X,De],styles:[".form-container[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;align-items:center;justify-content:center}.form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;padding:0 2em}.input-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%}.buttons-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:4em;width:100%;margin-top:2em}.button[_ngcontent-%COMP%]{width:190px;height:45px}.alert-error-custom[_ngcontent-%COMP%]{background:#fdecea;color:#b71c1c;border:1px solid #f5c6cb;border-radius:6px;padding:10px 14px;margin-top:8px;font-size:15px;display:flex;align-items:center;gap:8px}.alert-error-custom[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#b71c1c;font-size:18px}.captcha-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin:18px 0 10px;width:100%}@media (max-width: 600px){.captcha-container[_ngcontent-%COMP%]{margin:12px 0 8px;transform:scale(.95)}.h-captcha[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{width:100%!important;min-width:0!important;max-width:100vw!important}}",".form-container[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;align-items:center;justify-content:center}.form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:75%;padding:0 2em}.input-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%}.buttons-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:4em;width:100%;margin-top:2em}.button[_ngcontent-%COMP%]{width:190px;height:45px}.input[_ngcontent-%COMP%]{width:100%}.isRegistered[_ngcontent-%COMP%]{margin-top:25px;font-weight:700}.isRegistered[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#02507e}.error-message-container[_ngcontent-%COMP%]{width:100%}.error-message[_ngcontent-%COMP%]{color:red;margin-left:15px;margin-top:3px;font-size:14px}.success-message[_ngcontent-%COMP%]{background-color:#90ee90;padding:2px;margin-top:3px;color:#000}.register-message[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;background-color:#90ee90;padding:2px;position:relative;top:1em;color:#000;font-weight:700}@media (max-width: 768px){.form[_ngcontent-%COMP%]{width:100%}}"]})}}return r})();var le=(()=>{class r{constructor(e,t,i,n,s){this.authService=e,this.sweetalertService=t,this.route=i,this.router=n,this.errorHandlerService=s,this.data={email:""},this.errorMessage="",this.hcaptchaToken="",this.onCaptchaVerify=p=>{this.hcaptchaToken=p},this.onCaptchaExpired=()=>{this.hcaptchaToken=""},this.onCaptchaError=p=>{this.hcaptchaToken="",this.errorMessage="Terjadi kesalahan pada hCaptcha. Silakan coba lagi."}}ngOnInit(){this.route.queryParams.subscribe(e=>{if(e.error){let t=e.error;this.sweetalertService.alert("Gagal",t,"error"),t&&this.router.navigate([],{relativeTo:this.route,queryParams:{error:null},queryParamsHandling:"merge"})}})}onSubmit(e){if(!this.hcaptchaToken){this.errorMessage="Silakan selesaikan verifikasi hCaptcha.";return}this.sweetalertService.loading("Mohon tunggu","Proses..."),this.authService.forgotPassword({email:e.email,hcaptchaToken:this.hcaptchaToken}).subscribe({next:()=>{this.sweetalertService.alert("","Permintaan reset password telah diproses. Silakan cek email Anda untuk instruksi selanjutnya.","success"),this.hcaptchaToken=""},error:t=>{this.errorHandlerService.alertError(t),this.hcaptchaToken=""}})}static{this.\u0275fac=function(t){return new(t||r)(c(P),c(M),c(N),c(C),c(A))}}static{this.\u0275cmp=h({type:r,selectors:[["app-forgot-password"]],decls:1,vars:2,consts:[["pageTitle","Forgot Password",3,"formSubmit","captchaVerified","captchaExpired","captchaError","data","hcaptchaToken"]],template:function(t,i){t&1&&(o(0,"app-email-form",0),d("formSubmit",function(s){return i.onSubmit(s)})("captchaVerified",function(s){return i.onCaptchaVerify(s)})("captchaExpired",function(){return i.onCaptchaExpired()})("captchaError",function(s){return i.onCaptchaError(s)}),a()),t&2&&l("data",i.data)("hcaptchaToken",i.hcaptchaToken)},dependencies:[Y,X],encapsulation:2})}}return r})();var et=["form"];function tt(r,_){if(r&1&&(o(0,"span",14),m(1),a()),r&2){let e=b();g(),ie(" ",e.message," ")}}var ze=(()=>{class r{constructor(){this.data={newPassword:"",confirmNewPassword:""},this.passwordMismatch=!1,this.message="",this.isNewPassVisible=!1,this.isConfirmNewPassVisible=!1,this.formSubmit=new v}newPassVisible(){this.isNewPassVisible=!this.isNewPassVisible}confirmNewPassVisible(){this.isConfirmNewPassVisible=!this.isConfirmNewPassVisible}checkPasswordMatch(){this.data.newPassword&&this.data.confirmNewPassword&&(this.passwordMismatch=this.data.newPassword!==this.data.confirmNewPassword,this.passwordMismatch?this.message="Password baru tidak sama":this.message="")}onSubmit(){this.form.valid&&this.formSubmit.emit(this.data)}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=h({type:r,selectors:[["app-reset-password-form"]],viewQuery:function(t,i){if(t&1&&V(et,5),t&2){let n;T(n=I())&&(i.form=n.first)}},inputs:{data:"data"},outputs:{formSubmit:"formSubmit"},decls:17,vars:10,consts:[["form","ngForm"],["newPassword","ngModel"],["confirmNewPassword","ngModel"],[1,"form-container"],[1,"form",3,"ngSubmit"],["pageTitle","Reset Password"],[1,"input-container"],["label","Password baru","autocomplete","new-password","inputMode","text","placeholder","Password baru","name","newPassword","required","","minLength","8","minLengthErrorMessage","Password harus berisi minimal 8 karakter dengan kombinasi huruf besar, huruf kecil, dan angka","pattern","^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).+$","patternErrorMessage","Password harus berisi minimal 8 karakter dengan kombinasi huruf besar, huruf kecil, dan angka",1,"input",3,"ngModelChange","togglePassClick","type","ngModel","isPassVisible","isRequired"],["label","Konfirmasi Password Baru","autocomplete","new-password","inputMode","text","placeholder","Konfirmasi password baru","name","confirmNewPassword","required","","minLength","8","minlength","8","minLengthErrorMessage","Password harus berisi minimal 8 karakter dengan kombinasi huruf besar, huruf kecil, dan angka","pattern","^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).+$","patternErrorMessage","Password harus berisi minimal 8 karakter dengan kombinasi huruf besar, huruf kecil, dan angka",1,"input",3,"ngModelChange","togglePassClick","type","ngModel","isPassVisible","isRequired"],[1,"error-message-container"],["class","error-message",4,"ngIf"],[1,"buttons-container"],["type","button","routerLink","/dashboard",1,"button"],["type","submit",1,"button",3,"disabled"],[1,"error-message"]],template:function(t,i){if(t&1){let n=x();o(0,"app-auth")(1,"div",3)(2,"form",4,0),d("ngSubmit",function(){return u(n),f(i.onSubmit())}),w(4,"app-title",5),o(5,"div",6)(6,"app-base-input",7,1),F("ngModelChange",function(p){return u(n),O(i.data.newPassword,p)||(i.data.newPassword=p),f(p)}),d("togglePassClick",function(){return u(n),f(i.newPassVisible())})("ngModelChange",function(){return u(n),f(i.checkPasswordMatch())}),a(),o(8,"app-base-input",8,2),F("ngModelChange",function(p){return u(n),O(i.data.confirmNewPassword,p)||(i.data.confirmNewPassword=p),f(p)}),d("togglePassClick",function(){return u(n),f(i.confirmNewPassVisible())})("ngModelChange",function(){return u(n),f(i.checkPasswordMatch())}),a(),o(10,"div",9),S(11,tt,2,1,"span",10),a()(),o(12,"div",11)(13,"app-white-button",12),m(14,"Kembali"),a(),o(15,"app-blue-button",13),m(16,"Simpan"),a()()()()()}if(t&2){let n=L(3);g(6),l("type",i.isNewPassVisible?"text":"password"),R("ngModel",i.data.newPassword),l("isPassVisible",i.isNewPassVisible)("isRequired",!0),g(2),l("type",i.isConfirmNewPassVisible?"text":"password"),R("ngModel",i.data.confirmNewPassword),l("isPassVisible",i.isConfirmNewPassVisible)("isRequired",!0),g(3),l("ngIf",i.passwordMismatch&&n.valid),g(4),l("disabled",n.invalid||i.passwordMismatch)}},dependencies:[G,Z,re,ne,J,E,K,H,z,Q,Fe,je,U,W,y,j,q],styles:[".form-container[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;align-items:center;justify-content:center}.buttons-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:4em;width:100%;margin-top:2em}.button[_ngcontent-%COMP%]{width:190px;height:45px}.reset-password-message[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;background-color:#90ee90;padding:2px;position:relative;top:1em;color:#000;font-weight:700}.error-message[_ngcontent-%COMP%]{color:red;margin-left:15px;margin-top:3px;font-size:14px}.alert-error-custom[_ngcontent-%COMP%]{background:#fdecea;color:#b71c1c;border:1px solid #f5c6cb;border-radius:6px;padding:10px 14px;margin-top:8px;font-size:15px;display:flex;align-items:center;gap:8px}.alert-error-custom[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#b71c1c;font-size:18px}",".form-container[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;align-items:center;justify-content:center}.form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:75%;padding:0 2em}.input-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%}.buttons-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:4em;width:100%;margin-top:2em}.button[_ngcontent-%COMP%]{width:190px;height:45px}.input[_ngcontent-%COMP%]{width:100%}.isRegistered[_ngcontent-%COMP%]{margin-top:25px;font-weight:700}.isRegistered[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#02507e}.error-message-container[_ngcontent-%COMP%]{width:100%}.error-message[_ngcontent-%COMP%]{color:red;margin-left:15px;margin-top:3px;font-size:14px}.success-message[_ngcontent-%COMP%]{background-color:#90ee90;padding:2px;margin-top:3px;color:#000}.register-message[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;background-color:#90ee90;padding:2px;position:relative;top:1em;color:#000;font-weight:700}@media (max-width: 768px){.form[_ngcontent-%COMP%]{width:100%}}"]})}}return r})();var me=(()=>{class r{constructor(e,t,i,n,s){this.route=e,this.router=t,this.authService=i,this.sweetalertService=n,this.errorHandlerService=s,this.data={token:this.route.snapshot.paramMap.get("token")||"",newPassword:"",confirmNewPassword:""}}onResetPassword(e){this.authService.resetPassword(e).subscribe({next:()=>{this.sweetalertService.alert("Berhasil!","Password berhasil diperbarui","success"),this.router.navigateByUrl("/login")},error:t=>{console.log(t),console.log(t),this.errorHandlerService.alertError(t)}})}static{this.\u0275fac=function(t){return new(t||r)(c(N),c(C),c(P),c(M),c(A))}}static{this.\u0275cmp=h({type:r,selectors:[["app-reset-password"]],decls:1,vars:1,consts:[[3,"formSubmit","data"]],template:function(t,i){t&1&&(o(0,"app-reset-password-form",0),d("formSubmit",function(s){return i.onResetPassword(s)}),a()),t&2&&l("data",i.data)},dependencies:[ze],encapsulation:2})}}return r})();var ee=(()=>{class r{constructor(e,t,i,n,s){this.authService=e,this.sweetalertService=t,this.errorHandlerService=i,this.route=n,this.router=s,this.data={email:""},this.message="",this.errorMessage="",this.hcaptchaToken=""}ngOnInit(){this.route.queryParams.subscribe(e=>{let t=e.token;t&&this.verifyAccount(t);let i=sessionStorage.getItem("unverified_email");i&&(this.data.email=i,sessionStorage.removeItem("unverified_email"))})}onSubmit(e){this.errorMessage="",this.sweetalertService.loading("Mohon tunggu","Proses..."),this.authService.resendVerification(e.email).subscribe({next:()=>{this.sweetalertService.close(),this.sweetalertService.alert("Berhasil","Tautan verifikasi telah dikirim ke email Anda. Periksa kotak masuk/spam.","success")},error:t=>{this.sweetalertService.close(),this.errorMessage=t?.error?.errors||"Terjadi kesalahan. Coba lagi."}})}verifyAccount(e){this.sweetalertService.loading("Mohon tunggu","Memverifikasi akun Anda..."),this.authService.verifyAccount(e).subscribe({next:t=>{this.sweetalertService.close(),this.sweetalertService.alert("Verifikasi Berhasil","Akun berhasil diverifikasi. Mengarahkan ke Dashboard...","success").then(()=>{this.authService.me().pipe(be(i=>{this.authService.setUserProfile(i.data)})).subscribe({complete:()=>{this.router.navigateByUrl("/dashboard")},error:i=>{this.router.navigateByUrl("/dashboard")}})})},error:t=>{this.sweetalertService.close(),t.status===400&&t.error?.message?.includes("Token tidak valid atau telah kadaluarsa")?this.sweetalertService.alert("Verifikasi Gagal","Tautan verifikasi tidak valid/kadaluarsa. Minta tautan baru di bawah.","error"):this.errorHandlerService.alertError(t)}})}onCaptchaVerify(e){this.hcaptchaToken=e}static{this.\u0275fac=function(t){return new(t||r)(c(P),c(M),c(A),c(N),c(C))}}static{this.\u0275cmp=h({type:r,selectors:[["app-account-verification"]],decls:1,vars:3,consts:[["pageTitle","Account Verification",3,"formSubmit","captchaVerified","data","errorMessage","hcaptchaToken"]],template:function(t,i){t&1&&(o(0,"app-email-form",0),d("formSubmit",function(s){return i.onSubmit(s)})("captchaVerified",function(s){return i.onCaptchaVerify(s)}),a()),t&2&&l("data",i.data)("errorMessage",i.errorMessage)("hcaptchaToken",i.hcaptchaToken)},dependencies:[Y],encapsulation:2})}}return r})();function it(r,_){if(r&1){let e=x();o(0,"div")(1,"h2"),m(2,"Verifikasi Berhasil"),a(),o(3,"p"),m(4,"Akun Anda berhasil diverifikasi. Silakan login untuk melanjutkan."),a(),o(5,"button",3),d("click",function(){u(e);let i=b();return f(i.goToLogin())}),m(6,"Ke Login"),a()()}}function rt(r,_){if(r&1){let e=x();o(0,"div")(1,"h2"),m(2,"Verifikasi Gagal"),a(),o(3,"p"),m(4,"Tautan verifikasi tidak valid atau sudah kadaluarsa."),a(),o(5,"button",3),d("click",function(){u(e);let i=b(2);return f(i.goToResend())}),m(6,"Minta Ulang Verifikasi"),a()()}}function nt(r,_){if(r&1&&S(0,rt,7,0,"div",2),r&2){let e=b(),t=L(4);l("ngIf",e.status==="failed")("ngIfElse",t)}}function ot(r,_){if(r&1){let e=x();o(0,"app-email-form",4),d("formSubmit",function(i){u(e);let n=b();return f(n.onSubmit(i))}),a()}if(r&2){let e=b();l("data",e.data)}}var We=(()=>{class r{constructor(e,t){this.route=e,this.router=t,this.status=null,this.data={}}ngOnInit(){this.route.queryParams.subscribe(e=>{let t=e.status;t==="success"||t==="failed"?this.status=t:this.status=null})}goToLogin(){this.router.navigateByUrl("/login")}goToResend(){this.router.navigateByUrl("/auth/account-verification")}onSubmit(e){}static{this.\u0275fac=function(t){return new(t||r)(c(N),c(C))}}static{this.\u0275cmp=h({type:r,selectors:[["app-verification"]],decls:5,vars:2,consts:[["failedBlock",""],["defaultBlock",""],[4,"ngIf","ngIfElse"],[3,"click"],["pageTitle","Account Verification",3,"formSubmit","data"]],template:function(t,i){if(t&1&&S(0,it,7,0,"div",2)(1,nt,1,2,"ng-template",null,0,fe)(3,ot,1,1,"ng-template",null,1,fe),t&2){let n=L(2);l("ngIf",i.status==="success")("ngIfElse",n)}},dependencies:[y,j,Y],styles:["h2[_ngcontent-%COMP%]{color:#2e7d32;margin-bottom:8px}p[_ngcontent-%COMP%]{margin-bottom:16px}button[_ngcontent-%COMP%]{background:#1976d2;color:#fff;border:none;padding:8px 16px;border-radius:4px;cursor:pointer}button[_ngcontent-%COMP%]:hover{background:#1565c0}div[ng-reflect-ng-if=false][_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#c62828}"]})}}return r})();var ve=(r,_)=>{let e=te(C),t=te(M),i=te(P),n="/auth/login",s=()=>(e.navigateByUrl(n),!1);return i.getUserProfile()?(e.navigateByUrl("/dashboard"),!1):!0};var at=[{path:"login",component:se,canActivate:[ve]},{path:"register",component:ce,canActivate:[ve]},{path:"password-reset",component:le},{path:"reset/:token",component:me},{path:"verification",component:ee},{path:"verify",component:ee},{path:"verified",component:We},{path:"",redirectTo:"login",pathMatch:"full"}],Ue=(()=>{class r{static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275mod=D({type:r})}static{this.\u0275inj=B({imports:[he.forChild(at),he]})}}return r})();var Yi=(()=>{class r{static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275mod=D({type:r})}static{this.\u0275inj=B({imports:[y,E,Ne,Ue,X.forRoot({siteKey:Te.hcaptchaSiteKey}),se,ce,le,me,ee]})}}return r})();export{Yi as AuthModule};
