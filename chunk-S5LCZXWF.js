import{b as h,c as d}from"./chunk-ERSWCUUE.js";import{t as m}from"./chunk-PTR267HX.js";import{A as f,B as w,X as o,p as S,t as n}from"./chunk-NHTCOLVS.js";var C=(p,r)=>{let i=o(m),u=o(h),g=o(d),v="/auth/login",a=()=>(i.navigateByUrl(v),!1),s=localStorage.getItem("user_profile");if(s){let t=JSON.parse(s).role?.name?.toLowerCase(),c=r.url.startsWith("/auth/verification")||r.url.startsWith("/auth/verify"),l=r.url.startsWith("/auth/login");return!0}else if(!s)return u.me().pipe(n(e=>{let t=e.data;localStorage.setItem("user_profile",JSON.stringify(t));let c=t.role?.name?.toLowerCase(),l=r.url.startsWith("/auth/verification")||r.url.startsWith("/auth/verify"),P=r.url.startsWith("/auth/login");return!0}),w(()=>(a(),S(!1))));return u.userProfile$.pipe(f(e=>e?e!==void 0:a()),n(e=>{if(!e)return a();let t=e.role?.name?.toLowerCase(),c=r.url.startsWith("/auth/verification")||r.url.startsWith("/auth/verify"),l=r.url.startsWith("/auth/login");return!0}))};var O=(p,r)=>{let i=o(m),u=o(h),g=o(d),v="/auth/login",a=e=>(e==="user"||["super admin","supervisor","lcu"].includes(e)?i.navigateByUrl("/dashboard"):i.navigateByUrl("/not-found"),!1),s=localStorage.getItem("user_profile");if(s){let t=JSON.parse(s).role?.name?.toLowerCase();return(p.data.roles||[]).map(l=>l.toLowerCase()).includes(t)?!0:(g.alert("Akses Ditolak","Role Anda tidak memiliki akses ke halaman ini.","error"),setTimeout(()=>a(t),1e3),!1)}return u.userProfile$.pipe(f(e=>e!==void 0),n(e=>{if(!e)return i.navigateByUrl(v),!1;let t=e.role?.name?.toLowerCase()||"";return(p.data.roles||[]).map(l=>l.toLowerCase()).includes(t)?!0:(g.alert("Akses Ditolak","Role Anda tidak memiliki akses ke halaman ini.","error"),setTimeout(()=>a(t),1e3),!1)}))};export{C as a,O as b};
